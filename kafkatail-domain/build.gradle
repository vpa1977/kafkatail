
buildscript {
	repositories {
		mavenCentral()
	}
	dependencies {
		classpath 'com.google.protobuf:protobuf-gradle-plugin:0.8.18'
	}
}

apply plugin: 'eclipse'
apply plugin: 'com.google.protobuf'
apply plugin: 'java'

// Note: for IntelliJ IDE to mark the generated files as source.
sourceSets {
	src {
		main {
			java {
				srcDirs 'build/generated/source/proto/main/grpc'
				srcDirs 'build/generated/source/proto/main/java'
			}
		}
	}
}

dependencies {
	repositories {
		mavenCentral()
	}
	implementation  "io.grpc:grpc-netty:${project.grpcVersion}"
	implementation  "io.grpc:grpc-protobuf:${project.grpcVersion}"
	implementation  "io.grpc:grpc-stub:${project.grpcVersion}"
	implementation group: 'javax.annotation', name: 'javax.annotation-api', version: '1.3.2'
}

protobuf {
	protoc { artifact = 'com.google.protobuf:protoc:3.21.0' }
	plugins {
		grpc {
			artifact = "io.grpc:protoc-gen-grpc-java:${grpcVersion}" // CURRENT_GRPC_VERSION

		}

		// commented out util backend is written in kotlin
//		grpckt {
//			artifact = "io.grpc:protoc-gen-grpc-kotlin:${project.grpcKotlinVersion}:jdk8@jar"
//		}
	}

	generateProtoTasks {
		all().forEach {
			it.builtins {
//			kotlin{}
				java{
				}
			}
		}
		all()*.plugins {
			grpc {}
//		grpckt{}
		}

	}
}



